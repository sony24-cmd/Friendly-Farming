<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seasonal Crop Suggestions - Farmers Friendly Smart Farming Assistant</title>
  <meta name="description" content="Get practical crop suggestions based on season, region, water availability, and budget." />
  <link rel="stylesheet" href="../css/main.css" />
  <script defer src="../js/common.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <a class="brand" href="../index.html">
        <div class="brand-mark" aria-hidden="true">FF</div>
        <div>
          <h1 class="brand-title">Farmers Friendly Smart Farming Assistant Seasonal Crop Planner</h1>
          <p class="brand-subtitle">Crop selection by season fit and field constraints</p>
        </div>
      </a>

      <div class="top-actions">
        <nav class="nav-inline" aria-label="Feature navigation">
          <a class="nav-link" href="language_selection_home_dashboard.html">Dashboard</a>
          <a class="nav-link" href="crop_disease_detection.html">Disease</a>
          <a class="nav-link" href="weather_advisory.html">Weather</a>
          <a class="nav-link" href="soil_analysis_fertilizer_recommendations.html">Soil</a>
          <a class="nav-link" href="government_schemes_information.html">Schemes</a>
        </nav>

        <label class="visually-hidden" for="languageSelector">Choose language</label>
        <select id="languageSelector" class="lang-select">
          <option value="en">English</option>
          <option value="hi">Hindi</option>
          <option value="te">Telugu</option>
        </select>
      </div>
    </div>
  </header>

  <main class="site-wrap">
    <section class="hero fade-up">
      <div class="hero-grid">
        <div>
          <h2 id="pageTitle" class="hero-title">Seasonal Crop Suggestions for Your Farm</h2>
          <p id="pageSubtitle" class="hero-copy">
            Choose region, season, water, and investment level. Farmers Friendly Agriculture ranks crops with suitability score and quick economics.
          </p>
        </div>
        <div class="kpi-grid">
          <article class="kpi-card">
            <p class="kpi-value">Suitability</p>
            <p id="kpiOne" class="kpi-label">Ranked crop list with clear score</p>
          </article>
          <article class="kpi-card">
            <p class="kpi-value">Comparison</p>
            <p id="kpiTwo" class="kpi-label">Select multiple crops and compare side by side</p>
          </article>
          <article class="kpi-card">
            <p class="kpi-value">Practical</p>
            <p id="kpiThree" class="kpi-label">Water and budget constraints considered first</p>
          </article>
        </div>
      </div>
    </section>

    <section class="card fade-up" style="margin-top:1rem; animation-delay:70ms;">
      <h3 class="section-title">Planning Inputs</h3>
      <div class="form-grid" style="margin-top:0.7rem;">
        <div>
          <label class="label" for="regionInput">Region</label>
          <select id="regionInput" class="select">
            <option value="north">North India</option>
            <option value="south" selected>South India</option>
            <option value="east">East India</option>
            <option value="west">West India</option>
            <option value="central">Central India</option>
          </select>
        </div>
        <div>
          <label class="label" for="seasonInput">Season</label>
          <select id="seasonInput" class="select">
            <option value="kharif">Kharif (Jun-Oct)</option>
            <option value="rabi">Rabi (Nov-Apr)</option>
            <option value="zaid">Zaid (Mar-Jun)</option>
            <option value="perennial">Perennial</option>
          </select>
        </div>
        <div>
          <label class="label" for="waterInput">Water Availability</label>
          <select id="waterInput" class="select">
            <option value="low">Low</option>
            <option value="medium" selected>Medium</option>
            <option value="high">High</option>
          </select>
        </div>
        <div>
          <label class="label" for="budgetInput">Investment Capacity</label>
          <select id="budgetInput" class="select">
            <option value="low">Low</option>
            <option value="medium" selected>Medium</option>
            <option value="high">High</option>
          </select>
        </div>
        <div>
          <label class="label" for="goalInput">Market Goal</label>
          <select id="goalInput" class="select">
            <option value="stable">Stable income</option>
            <option value="high-return">High return</option>
            <option value="fast-cash">Fast cash cycle</option>
          </select>
        </div>
      </div>

      <div class="inline" style="margin-top:0.85rem;">
        <button id="generateBtn" class="btn btn-primary" type="button">Generate Crop Suggestions</button>
        <button id="compareBtn" class="btn btn-ghost" type="button">Compare Selected</button>
        <span id="resultState" class="badge info">Waiting for selection</span>
      </div>
    </section>

    <section class="card fade-up" style="margin-top:1rem; animation-delay:120ms;">
      <h3 class="section-title">Recommended Crops</h3>
      <div id="suggestionsWrap" class="card-grid three" style="margin-top:0.7rem;"></div>
    </section>

    <section id="comparisonSection" class="card fade-up" style="margin-top:1rem; display:none;">
      <h3 class="section-title">Crop Comparison</h3>
      <div id="comparisonWrap" class="table-wrap" style="margin-top:0.6rem;"></div>
      <div class="inline" style="margin-top:0.8rem;">
        <button id="speakCompareBtn" class="btn btn-secondary small" type="button">Play Comparison Audio</button>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-grid">
      <p>Farmers Friendly Smart Farming Assistant Seasonal Planner</p>
      <p>Final crop decision should include local market and field survey. <span data-year></span></p>
    </div>
  </footer>

  <nav class="mobile-tabs" aria-label="Mobile navigation">
    <a href="language_selection_home_dashboard.html">Home</a>
    <a href="crop_disease_detection.html">Disease</a>
    <a href="weather_advisory.html">Weather</a>
    <a href="soil_analysis_fertilizer_recommendations.html">Soil</a>
    <a href="government_schemes_information.html">Schemes</a>
  </nav>

  <script>
    (function () {
      var lastSuggestions = [];
      var selectedIds = {};

      var cropDB = [
        {
          id: "rice",
          name: "Rice (Paddy)",
          seasons: ["kharif"],
          regions: ["east", "south", "north"],
          water: "high",
          budget: "medium",
          goal: ["stable", "high-return"],
          yield: "18-24 qtl/acre",
          investment: "INR 22k-32k/acre"
        },
        {
          id: "wheat",
          name: "Wheat",
          seasons: ["rabi"],
          regions: ["north", "west", "central"],
          water: "medium",
          budget: "medium",
          goal: ["stable"],
          yield: "15-20 qtl/acre",
          investment: "INR 16k-24k/acre"
        },
        {
          id: "maize",
          name: "Maize",
          seasons: ["kharif", "zaid"],
          regions: ["north", "south", "central", "east"],
          water: "medium",
          budget: "medium",
          goal: ["fast-cash", "stable"],
          yield: "20-26 qtl/acre",
          investment: "INR 17k-25k/acre"
        },
        {
          id: "groundnut",
          name: "Groundnut",
          seasons: ["kharif", "zaid"],
          regions: ["south", "west", "central"],
          water: "low",
          budget: "low",
          goal: ["fast-cash", "high-return"],
          yield: "8-12 qtl/acre",
          investment: "INR 13k-21k/acre"
        },
        {
          id: "cotton",
          name: "Cotton",
          seasons: ["kharif"],
          regions: ["west", "south", "central"],
          water: "medium",
          budget: "high",
          goal: ["high-return"],
          yield: "10-14 qtl/acre",
          investment: "INR 25k-40k/acre"
        },
        {
          id: "millet",
          name: "Millets",
          seasons: ["kharif", "rabi"],
          regions: ["south", "central", "west"],
          water: "low",
          budget: "low",
          goal: ["stable", "fast-cash"],
          yield: "7-11 qtl/acre",
          investment: "INR 10k-16k/acre"
        },
        {
          id: "tomato",
          name: "Tomato",
          seasons: ["zaid", "rabi"],
          regions: ["south", "west", "east", "north"],
          water: "high",
          budget: "high",
          goal: ["high-return", "fast-cash"],
          yield: "90-130 qtl/acre",
          investment: "INR 45k-80k/acre"
        },
        {
          id: "onion",
          name: "Onion",
          seasons: ["rabi", "zaid"],
          regions: ["west", "south", "north"],
          water: "medium",
          budget: "medium",
          goal: ["high-return", "stable"],
          yield: "70-100 qtl/acre",
          investment: "INR 30k-55k/acre"
        }
      ];

      var translation = {
        en: {
          pageTitle: "Seasonal Crop Suggestions for Your Farm",
          pageSubtitle: "Choose region, season, water, and investment level. Farmers Friendly Agriculture ranks crops with suitability score and quick economics.",
          kpiOne: "Ranked crop list with clear score",
          kpiTwo: "Select multiple crops and compare side by side",
          kpiThree: "Water and budget constraints considered first"
        },
        hi: {
          pageTitle: "Aapke farm ke liye seasonal crop sujhav",
          pageSubtitle: "Region, season, paani aur budget select karein. Farmers Friendly Agriculture suitability score ke saath crop rank karega.",
          kpiOne: "Clear score ke saath ranked crop list",
          kpiTwo: "Multiple crop select karke compare karein",
          kpiThree: "Paani aur budget constraints pe pehla dhyan"
        },
        te: {
          pageTitle: "Mee farm kosam seasonal crop suggestions",
          pageSubtitle: "Region, season, water, budget select chesi Farmers Friendly Agriculture suitability score tho crop rank chesukondi.",
          kpiOne: "Clear score tho ranked crop list",
          kpiTwo: "Anekam crops select chesi compare cheyyandi",
          kpiThree: "Water mariyu budget constraints first priority"
        }
      };

      function applyLanguage(language) {
        var text = translation[language] || translation.en;
        Object.keys(text).forEach(function (id) {
          var node = document.getElementById(id);
          if (node) {
            node.textContent = text[id];
          }
        });
      }

      function levelScore(userLevel, cropLevel) {
        var order = { low: 1, medium: 2, high: 3 };
        if (userLevel === cropLevel) {
          return 15;
        }
        if (order[userLevel] > order[cropLevel]) {
          return 12;
        }
        return 7;
      }

      function buildSuggestions() {
        var filters = {
          region: document.getElementById("regionInput").value,
          season: document.getElementById("seasonInput").value,
          water: document.getElementById("waterInput").value,
          budget: document.getElementById("budgetInput").value,
          goal: document.getElementById("goalInput").value
        };

        lastSuggestions = cropDB.map(function (crop) {
          var score = 0;

          score += crop.seasons.indexOf(filters.season) >= 0 ? 35 : 8;
          score += crop.regions.indexOf(filters.region) >= 0 ? 20 : 9;
          score += levelScore(filters.water, crop.water);
          score += levelScore(filters.budget, crop.budget);
          score += crop.goal.indexOf(filters.goal) >= 0 ? 15 : 7;

          return {
            crop: crop,
            score: Math.min(score, 100)
          };
        }).sort(function (a, b) {
          return b.score - a.score;
        });

        renderSuggestions();
      }

      function suitabilityBadge(score) {
        if (score >= 80) {
          return "<span class=\"badge good\">Highly Suitable</span>";
        }
        if (score >= 65) {
          return "<span class=\"badge warn\">Moderately Suitable</span>";
        }
        return "<span class=\"badge risk\">Conditional Fit</span>";
      }

      function renderSuggestions() {
        var wrap = document.getElementById("suggestionsWrap");
        wrap.innerHTML = "";

        if (!lastSuggestions.length) {
          wrap.innerHTML = "<div class=\"empty-state\">No crops matched this filter.</div>";
          return;
        }

        lastSuggestions.slice(0, 6).forEach(function (entry) {
          var card = document.createElement("article");
          card.className = "card-link";
          card.innerHTML =
            suitabilityBadge(entry.score) +
            "<h4 class=\"card-title\" style=\"margin-top:0.55rem;\">" + entry.crop.name + "</h4>" +
            "<p class=\"card-body\">Suitability score: <strong>" + entry.score + "/100</strong></p>" +
            "<p class=\"card-body\">Expected yield: " + entry.crop.yield + "</p>" +
            "<p class=\"card-body\">Typical investment: " + entry.crop.investment + "</p>" +
            "<label style=\"display:flex; gap:0.4rem; align-items:center; margin-top:0.45rem; font-size:0.86rem;\">" +
            "<input type=\"checkbox\" data-crop-id=\"" + entry.crop.id + "\" " + (selectedIds[entry.crop.id] ? "checked" : "") + " />" +
            "Select for comparison</label>";
          wrap.appendChild(card);
        });

        wrap.querySelectorAll("input[type='checkbox']").forEach(function (box) {
          box.addEventListener("change", function (event) {
            var id = event.target.getAttribute("data-crop-id");
            selectedIds[id] = event.target.checked;
          });
        });

        document.getElementById("resultState").textContent = "Suggestions generated";
        document.getElementById("resultState").className = "badge good";
      }

      function openComparison() {
        var selected = lastSuggestions.filter(function (entry) {
          return selectedIds[entry.crop.id];
        });

        if (selected.length < 2) {
          window.AgroAI.toast("Select at least two crops", "error");
          return;
        }

        var rows = "<table class=\"table\"><thead><tr><th>Crop</th><th>Score</th><th>Yield</th><th>Investment</th><th>Water Need</th></tr></thead><tbody>";
        selected.forEach(function (entry) {
          rows += "<tr><td>" + entry.crop.name + "</td><td>" + entry.score + "/100</td><td>" + entry.crop.yield + "</td><td>" + entry.crop.investment + "</td><td>" + entry.crop.water + "</td></tr>";
        });
        rows += "</tbody></table>";

        document.getElementById("comparisonWrap").innerHTML = rows;
        document.getElementById("comparisonSection").style.display = "block";
      }

      function speakComparison() {
        var selected = lastSuggestions.filter(function (entry) {
          return selectedIds[entry.crop.id];
        });

        if (!selected.length) {
          window.AgroAI.toast("Create comparison first", "error");
          return;
        }

        if (!("speechSynthesis" in window)) {
          window.AgroAI.toast("Speech not supported on this browser", "error");
          return;
        }

        var message = "Top compared crops are: " + selected.map(function (entry) {
          return entry.crop.name + " score " + entry.score;
        }).join(", ");

        var utterance = new SpeechSynthesisUtterance(message);
        utterance.rate = 0.95;
        speechSynthesis.cancel();
        speechSynthesis.speak(utterance);
      }

      document.addEventListener("DOMContentLoaded", function () {
        window.AgroAI.setupLanguage("languageSelector", applyLanguage);
        document.getElementById("generateBtn").addEventListener("click", buildSuggestions);
        document.getElementById("compareBtn").addEventListener("click", openComparison);
        document.getElementById("speakCompareBtn").addEventListener("click", speakComparison);
        buildSuggestions();
      });
    })();
  </script>
</body>
</html>

